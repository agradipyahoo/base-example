<!DOCTYPE html>
<html>
<head>
    <title>New App</title>
    <link rel="stylesheet" href="css/bootstrap.css"/>
    <link href="js/libs/pretty/prettify.css" type="text/css" rel="stylesheet" />
    <style type="text/css">
        body {
            background-color: #efefef;
        }

        #header {
            background-color: #000;
            padding: 10px 10px 10px 20px;
        }

        .logo {
            background: url("images/logo.png") no-repeat center center;
            width: 100px;
            height: 30px;
            display: inline-block;
            text-indent: -999em;
            float: left;
        }

        .nav-pills {
            float: left;
            margin-bottom: 0;
            margin-left: 50px;

        }

        .nav-pills li a {
            text-transform: uppercase;
        }
        .element{
            clear:both;
        }

        .preview{
            padding: 20px;
            border: 2px solid #e1e1e8;
            border-radius: 10px;
        }

        .loading {
            opacity: 0.5;
            position: relative;
        }

        .loading:after{
            content: 'Loading';
            position: absolute;
            top:50%;
            bottom:0;
            left:0;
            right:0;
            text-align: center;
        }
    </style>
</head>
<body>


<div class="row-fluid">
    <div class="span12" id="header">

    </div>
</div>
<div class="row-fluid">
    <div class="span2 left-nav">
        <!--Sidebar content-->
    </div>
    <div class="span10">
        <div id="app-body">

        </div>
    </div>
</div>


<script type="text/javascript" src="js/libs/pretty/prettify.js"></script>
<script type="text/javascript" src="js/libs/jquery-1.9.1.js"></script>
<script type="text/javascript" src="js/libs/underscore.js"></script>
<script type="text/javascript" src="js/libs/backbone.js"></script>
<script type="text/javascript" src="js/libs/md5-min.js"></script>
<script type="text/javascript" src="js/libs/handlebars.js"></script>
<script type="text/javascript" src="js/libs/require-min.js"></script>
<script type="text/javascript" src="js/libs/list-base-widget.js"></script>

<script type="text/javascript">
    require.config({
        appDir: '../',
        baseUrl: './js',
        paths: {
            jquery: "empty:",
            underscore: "empty:",
            backbone: "empty:",
            'text':'libs/requirejs-text-plugin'
        },
        dir: '../dist',
        //optimize: 'none',
        fileExclusionRegExp: /(build|idea)/,
        modules: [

            {
                name: 'apps/examples',
                include: [
                    'apps/examples/app'
                ],
                exclude: ['common']
            }


        ]
    });

    require(['base', 'widgets/header'],function(Base,Header){

        var app = Base.app;
        app.defaultApp = 'examples';
        var BaseView = Base.View, BaseModel = Base.Model;

        var PageView = BaseView.extend({
            postRender:function(){
                var header = new Header.View({
                    el:this.$('#header'),
                    model:this.model
                });
                header.render();
            },
            changeHandler:function(changes){
                var attr = this.model.toJSON();
                if(changes.appId){
                    require(['apps/'+attr.appId],function(){
                        require(['apps/'+attr.appId+'/app'], function(app){
                            app.renderPage(attr.pageId, attr);
                        })
                    })
                }else if(changes.pageId){
                    require(['apps/'+attr.appId+'/app'], function(app){
                        app.renderPage(attr.pageId, attr);
                    })
                }
            }
        });

        var PageModel = BaseModel.extend({

        })


        var model =  new PageModel();
        var view = new PageView({
            model:model,
            el:$('body')
        })

        app.appModel = model;

        view.postRender();

        Backbone.history.start({
            root: this.root
        })
    });
</script>

</body>
</html>